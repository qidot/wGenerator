var smUserList=function(){var b="#user_list_table";var c="#user_list_search_form";function a(d){var e={id:"#user_list_table",container:"#user_list_container",url:"/api/sm/getUsers",queryData:d,header:["编号","用户名","头像","昵称","姓名","角色","手机号","性别","职业","省","市","状态","创建时间"],columns:[{name:"id",index:"id",width:60,sorttype:"int",search:true},{name:"userName",index:"user_name",width:90,align:"center"},{name:"headerImage",index:"header_image",width:90,align:"center",sortable:false,formatter:formatAvator},{name:"nickName",index:"nick_name",width:100,align:"center"},{name:"realName",index:"real_name",width:80,align:"center"},{name:"roleName",index:"role_list",width:80,align:"center"},{name:"mobile",index:"mobile",width:80,align:"center"},{name:"genderName",index:"gender",width:80,align:"center"},{name:"professionName",index:"profession",width:80,align:"center"},{name:"province",index:"province",width:80,align:"center"},{name:"city",index:"city",width:80,align:"center"},{name:"enable",index:"enable",width:80,align:"center",sorttype:"int",formatter:formatEnable},{name:"created",index:"created",width:100,sortable:false,formatter:"datetime"}],pager:"#user_list_pager",};mountGrid(e)}return{ready:function(){initFormRemoteData(c);a()},add:function(){openWindow("/view/userEdit",{})},edit:function(){var d=getGridSelect(b,"请先选中行",false);if(d!=null){openWindow("/view/userEdit",{userName:d.userName})}},addReward:function(){var d=getGridSelect(b,"请先选中行",false);if(d!=null){openWindow("/view/addReward",{userName:d.userName})}},resetPwd:function(){var d=getGridSelect(b,"请选择要重置密码的用户!",false);if(d!=null){myConfirm("您确定要重置用户["+d.userName+"]的密码吗？",null,function(e){if(!e){return}myAjax("/api/sm/resetPwd",{userName:d.userName},function(f){if(f.success){if(f.data===""){tip("密码修改成功","提示","success")}else{myAlert("密码重置成功,请复制或牢记!",f.data,"success")}}else{tip(f.message)}},function(f,g){tip(g)})})}},removeUser:function(){var d=getGridSelect(b,"请选择要删除的用户!",true);if(d!=null){myConfirm("您确定要删除["+d.length+"]个用户吗？",null,function(f){if(!f){return}var e=[];$.each(d,function(h,g){e.push(parseInt(g.id))});myAjax("/api/sm/removeUser",{ids:e},function(g){if(g.success){tip("用户删除成功","提示","success");smUserList.reloadGrid()}else{tip(g.message)}},function(g,h){tip(h)})})}},forceOffline:function(){var d=getGridSelect(b,"请选择要强制下线的用户!",true);if(d!=null){myConfirm("您确定要强制下线["+d.length+"]个用户吗？",null,function(f){if(!f){return}var e=[];$.each(d,function(h,g){e.push(parseInt(g.id))});myAjax("/api/sm/forceOffline",{ids:e},function(g){if(g.success){tip("用户已成功下线","提示","success")}else{tip(g.message)}},function(g,h){tip(h)})})}},reloadGrid:function(){refreshGrid(b,c);return false}}}();